environment:

  matrix:

    # Variables:
    # https://help.appveyor.com/discussions/problems/4629-how-to-use-appveyor-environment-variable
    # https://help.appveyor.com/discussions/questions/15163-multiuple-build-matrix-dimensions-from-environment-variables
    - PYTHON: "C:\\Python36-x64"
      PYTHON_VERSION: "3.6.4"
      PYTHON_ARCH: "64"
      GRUNT_COMMAND: test
    - PYTHON: "C:\\Python36-x64"
      PYTHON_VERSION: "3.6.4"
      PYTHON_ARCH: "64"
      GRUNT_COMMAND: build

platform: x64

# Build configuration
# https://www.appveyor.com/docs/build-configuration/#build-pipeline
install:

  # Needs, because will get messages as:
  # «flake8 is not recognized»
  # https://github.com/ogrisel/python-appveyor-demo/blob/master/appveyor.yml
  # Python 2 by default, see:
  # https://www.appveyor.com/docs/build-environment/#python
  # https://ci.appveyor.com/project/Kristinita/erichek/build/1.0.3
  - "SET PATH=%PYTHON%;%PYTHON%\\Scripts;%PATH%"

  - choco install nodejs -y
  - pip install --upgrade pip
  - pip install pipenv
  - setx PIPENV_VENV_IN_PROJECT 1
  - pipenv install --dev
  - npm install -g grunt-cli
  - npm install

build_script:

  # Needs AppVeyor console set, see:
  # https://stackoverflow.com/a/48093971/5951529
  - set PYTHONIOENCODING=utf-8
  - grunt %GRUNT_COMMAND%
